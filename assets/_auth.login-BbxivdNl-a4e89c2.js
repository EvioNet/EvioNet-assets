import{b as N,a as g,D as b,r as v,t as a,o as F,j as e,L as S,s as l}from"./index-DYkXUbAd-a4e89c2.js";import{B as w}from"./button-h1DSpZXA-a4e89c2.js";import{u as y,a as E,F as L,b as n,c as i,d as m,e as c,f as d}from"./zod-Bbw9K68C-a4e89c2.js";import{I as x}from"./input-q4GhQ_CN-a4e89c2.js";import{l as k,M as R,L as C}from"./passport-C71OHJZJ-a4e89c2.js";import{u as I}from"./index.esm-5B-ngkc2-a4e89c2.js";import"./utils-CqKNptqL-a4e89c2.js";import"./label-CVp5bNyn-a4e89c2.js";import"./index-uuJbZfHU-a4e89c2.js";const M=F({email:l().email("请输入有效的邮箱地址"),password:l().min(6,"密码至少需要6个字符")}),J=function(){const u=N(),{setAuth:f}=g(),{state:r}=b.useSearch();v.useEffect(()=>{r==="Expired"&&a.error("您的登录已过期，请重新登录"),r==="Unauthorized"&&a.error("您需要先登录才能访问该页面"),r==="TokenExpired"&&a.error("您的登录已过期，请重新登录")},[]);const t=y({resolver:E(M),defaultValues:{email:"",password:""}}),{send:p,loading:o}=I(({email:s,password:j})=>k({email:s,password:j}),{immediate:!1}).onSuccess(s=>{s.data.token&&(f(s.data),a.success("登录成功"),u({to:"/dashboard"}))}),h=s=>{p(s)};return e.jsx(L,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(h),className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"登录您的账户"}),e.jsx("p",{className:"text-muted-foreground text-sm text-balance",children:"请输入您的邮箱以登录您的账户"})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx(n,{control:t.control,name:"email",render:({field:s})=>e.jsxs(i,{children:[e.jsx(m,{children:"邮箱"}),e.jsx(c,{children:e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(x,{type:"email",placeholder:"邮箱",className:"pl-10",...s})]})}),e.jsx(d,{})]})}),e.jsx(n,{control:t.control,name:"password",render:({field:s})=>e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{children:"密码"}),e.jsx("a",{href:"#",className:"ml-auto text-sm underline-offset-4 hover:underline",children:"忘记密码？"})]}),e.jsx(c,{children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(x,{type:"password",placeholder:"密码",className:"pl-10",...s})]})}),e.jsx(d,{})]})}),e.jsx(w,{type:"submit",className:"w-full",disabled:o,children:o?"登录中...":"登录"})]}),e.jsxs("div",{className:"text-center text-sm",children:["还没有账户？"," ",e.jsx(S,{to:"/register",className:"underline underline-offset-4",children:"注册"})]})]})})};export{J as component};
