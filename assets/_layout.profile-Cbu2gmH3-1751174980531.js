import{r as i,j as e,a as H,t as A,g as Q,h as Y,k as Z,o as ee,l as se,s as N}from"./index-zp2nMl9D-1751174980531.js";import{B as re}from"./button-Cqc4v3GU-1751174980531.js";import{a as I,b as E,c as te,d as T,C as q}from"./card-Dg8wDAoB-1751174980531.js";import{u as ae,a as oe,F as ne,b as _,c as v,d as S,e as y,f as k}from"./zod-BqX1wKj--1751174980531.js";import{I as C}from"./input-BhTRTT4z-1751174980531.js";import{L as F}from"./label-pehihN3l-1751174980531.js";import{c as ce}from"./index-Dc_FVRD7-1751174980531.js";import{u as z,c as M}from"./utils-BIJI3SUY-1751174980531.js";import{c as de}from"./index-Decz7uho-1751174980531.js";import{u as ie}from"./index-CjSUaoDh-1751174980531.js";import{u as le}from"./index-DCTzC_qL-1751174980531.js";import{u as me}from"./index-NLxs7AO6-1751174980531.js";import{P as D}from"./index-BT14nGiI-1751174980531.js";import{S as P}from"./skeleton-BIaGqfRO-1751174980531.js";import{b as R}from"./formatters-C5M2-kaB-1751174980531.js";import{S as pe}from"./static-magic-card-BmaJrWCa-1751174980531.js";import{u as W,a as ue}from"./index.esm-B4TPyIND-1751174980531.js";import{c as xe}from"./createLucideIcon-Ru6o5lSX-1751174980531.js";import{G as he}from"./gift-IT_1ySA6-1751174980531.js";import{T as fe}from"./trending-up-BWu9kPgr-1751174980531.js";import"./package-CC7CMkB8-1751174980531.js";import"./circle-check-big-DX17IEmj-1751174980531.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],U=xe("wallet",be);var f="Switch",[je,Ke]=de(f),[ge,we]=je(f),G=i.forwardRef((r,a)=>{const{__scopeSwitch:s,name:o,checked:t,defaultChecked:c,required:n,disabled:d,value:l="on",onCheckedChange:b,form:m,...j}=r,[p,u]=i.useState(null),g=z(a,h=>u(h)),w=i.useRef(!1),B=p?m||!!p.closest("form"):!0,[x,J]=ie({prop:t,defaultProp:c??!1,onChange:b,caller:f});return e.jsxs(ge,{scope:s,checked:x,disabled:d,children:[e.jsx(D.button,{type:"button",role:"switch","aria-checked":x,"aria-required":n,"data-state":$(x),"data-disabled":d?"":void 0,disabled:d,value:l,...j,ref:g,onClick:ce(r.onClick,h=>{J(K=>!K),B&&(w.current=h.isPropagationStopped(),w.current||h.stopPropagation())})}),B&&e.jsx(X,{control:p,bubbles:!w.current,name:o,value:l,checked:x,required:n,disabled:d,form:m,style:{transform:"translateX(-100%)"}})]})});G.displayName=f;var O="SwitchThumb",V=i.forwardRef((r,a)=>{const{__scopeSwitch:s,...o}=r,t=we(O,s);return e.jsx(D.span,{"data-state":$(t.checked),"data-disabled":t.disabled?"":void 0,...o,ref:a})});V.displayName=O;var Ne="SwitchBubbleInput",X=i.forwardRef(({__scopeSwitch:r,control:a,checked:s,bubbles:o=!0,...t},c)=>{const n=i.useRef(null),d=z(n,c),l=le(s),b=me(a);return i.useEffect(()=>{const m=n.current;if(!m)return;const j=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(j,"checked").set;if(l!==s&&u){const g=new Event("click",{bubbles:o});u.call(m,s),m.dispatchEvent(g)}},[l,s,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...t,tabIndex:-1,ref:d,style:{...t.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X.displayName=Ne;function $(r){return r?"checked":"unchecked"}var _e=G,ve=V;function L({className:r,...a}){return e.jsx(_e,{"data-slot":"switch",className:M("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...a,children:e.jsx(ve,{"data-slot":"switch-thumb",className:M("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const Se=ee({old_password:N().min(1,"请输入当前密码"),new_password:N().min(6,"新密码至少需要6位字符"),confirm_password:N().min(1,"请确认新密码")}).refine(r=>r.new_password===r.confirm_password,{message:"两次输入的密码不一致",path:["confirm_password"]}).refine(r=>r.old_password!==r.new_password,{message:"新密码不能与当前密码相同",path:["new_password"]});function ye(){const{send:r,loading:a}=W(({old_password:t,new_password:c})=>Z({old_password:t,new_password:c}),{immediate:!1}).onSuccess(()=>{A.success("密码修改成功")}),s=ae({resolver:oe(Se),defaultValues:{old_password:"",new_password:"",confirm_password:""}}),o=async t=>{r({old_password:t.old_password,new_password:t.new_password}),s.reset()};return e.jsxs(q,{children:[e.jsx(I,{children:e.jsx(E,{children:"修改密码"})}),e.jsx(T,{children:e.jsx(ne,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(o),className:"space-y-4",children:[e.jsx(_,{control:s.control,name:"old_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"当前密码"}),e.jsx(y,{children:e.jsx(C,{type:"password",placeholder:"请输入当前密码",...t})}),e.jsx(k,{})]})}),e.jsx(_,{control:s.control,name:"new_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"新密码"}),e.jsx(y,{children:e.jsx(C,{type:"password",placeholder:"请输入新密码（至少6位）",...t})}),e.jsx(k,{})]})}),e.jsx(_,{control:s.control,name:"confirm_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"确认新密码"}),e.jsx(y,{children:e.jsx(C,{type:"password",placeholder:"请再次输入新密码",...t})}),e.jsx(k,{})]})}),e.jsx(re,{type:"submit",className:"w-full",disabled:a,children:a?"修改中...":"修改密码"})]})})})]})}function ke(){const r=Q.useLoaderData(),{setUserInfo:a}=H(),[s,o]=i.useState({remind_expire:r.remind_expire,remind_traffic:r.remind_traffic}),{loading:t}=ue(()=>se({remind_expire:s.remind_expire?1:0,remind_traffic:s.remind_traffic?1:0}),[s]).onSuccess(()=>{A.success("设置已自动保存"),a({...r,remind_expire:s.remind_expire,remind_traffic:s.remind_traffic})}),c=(n,d)=>{o(l=>({...l,[n]:d}))};return e.jsxs(q,{children:[e.jsx(I,{children:e.jsx(E,{children:"通知设置"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx(F,{className:"text-base",children:"到期提醒"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"当您的订阅即将到期时，我们会发送提醒通知"})]}),e.jsx(L,{checked:s.remind_expire,onCheckedChange:n=>c("remind_expire",n),disabled:t})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx(F,{className:"text-base",children:"流量提醒"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"当您的流量使用量达到一定比例时，我们会发送提醒通知"})]}),e.jsx(L,{checked:s.remind_traffic,onCheckedChange:n=>c("remind_traffic",n),disabled:t})]})]})]})}function Ce(){const{setUserInfo:r}=H(),{data:a,loading:s}=W(Y,{force:!0}).onSuccess(({data:o})=>{r(o)});return e.jsxs(pe,{gradientPosition:"top",children:[e.jsxs(I,{className:"pb-3",children:[e.jsxs(E,{className:"flex items-center gap-2 text-lg font-bold",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-primary/10 text-primary",children:e.jsx(U,{className:"h-5 w-5"})}),"账户余额"]}),e.jsx(te,{className:"text-sm text-muted-foreground/80",children:"您的资产概览和余额详情"})]}),e.jsx(T,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(U,{className:"h-3 w-3 text-primary"})}),"账户余额"]}),s?e.jsx(P,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R(a.balance)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"可用于购买套餐"})]}),e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(he,{className:"h-3 w-3 text-primary"})}),"佣金余额"]}),s?e.jsx(P,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R(a.commission_balance)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"邀请奖励收益"})]}),e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(fe,{className:"h-3 w-3 text-primary"})}),"总资产"]}),s?e.jsx(P,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R((a.balance||0)+(a.commission_balance||0))]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"账户余额 + 佣金余额"})]})]})})]})}const Qe=function(){return e.jsxs("div",{className:"container mx-auto space-y-6",children:[e.jsx(Ce,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ye,{}),e.jsx(ke,{})]})]})};export{Qe as component};
