import{r as d,j as e,a as J,t as H,h as L,k as K,o as Q,l as Y,s as _}from"./index-CFrvu99Y-0b001e1.js";import{c as Z,B as ee}from"./button-OUq2HN3_-0b001e1.js";import{a as E,b as T,c as se,d as B,C as A}from"./card-DBTexpMc-0b001e1.js";import{u as re,a as te,F as ae,b as y,c as v,d as S,e as k,f as C}from"./zod-3P1cG8bn-0b001e1.js";import{I as P}from"./input-CdS7CAOy-0b001e1.js";import{L as oe}from"./label-CCUQTZGL-0b001e1.js";import{c as ne}from"./index-Dc_FVRD7-0b001e1.js";import{u as q,c as M}from"./utils-DGJa7bZG-0b001e1.js";import{c as ce}from"./index-CPzO37nU-0b001e1.js";import{u as de}from"./index-B50u4-99-0b001e1.js";import{u as ie}from"./index-mjitljEt-0b001e1.js";import{u as le}from"./index-BUl5N7pE-0b001e1.js";import{P as z}from"./index-B42L2BaG-0b001e1.js";import{S as I}from"./skeleton-BR9LzH-n-0b001e1.js";import{b as R}from"./formatters-DpdTcjfQ-0b001e1.js";import{S as me}from"./static-magic-card-WWULp_wa-0b001e1.js";import{u as f}from"./index.esm-B3kCPiJ0-0b001e1.js";import{G as pe}from"./gift-BkIbxEAu-0b001e1.js";import{T as ue}from"./trending-up-Cn8k05jm-0b001e1.js";import"./package-B1YrBFeQ-0b001e1.js";import"./circle-check-big-B7Kvin5X-0b001e1.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],U=Z("wallet",xe);var b="Switch",[he,Xe]=ce(b),[fe,be]=he(b),D=d.forwardRef((s,o)=>{const{__scopeSwitch:r,name:n,checked:t,defaultChecked:i,required:a,disabled:c,value:l="on",onCheckedChange:j,form:m,...g}=s,[p,u]=d.useState(null),w=q(o,h=>u(h)),N=d.useRef(!1),F=p?m||!!p.closest("form"):!0,[x,X]=de({prop:t,defaultProp:i??!1,onChange:j,caller:b});return e.jsxs(fe,{scope:r,checked:x,disabled:c,children:[e.jsx(z.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":W(x),"data-disabled":c?"":void 0,disabled:c,value:l,...g,ref:w,onClick:ne(s.onClick,h=>{X($=>!$),F&&(N.current=h.isPropagationStopped(),N.current||h.stopPropagation())})}),F&&e.jsx(V,{control:p,bubbles:!N.current,name:n,value:l,checked:x,required:a,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});D.displayName=b;var G="SwitchThumb",O=d.forwardRef((s,o)=>{const{__scopeSwitch:r,...n}=s,t=be(G,r);return e.jsx(z.span,{"data-state":W(t.checked),"data-disabled":t.disabled?"":void 0,...n,ref:o})});O.displayName=G;var je="SwitchBubbleInput",V=d.forwardRef(({__scopeSwitch:s,control:o,checked:r,bubbles:n=!0,...t},i)=>{const a=d.useRef(null),c=q(a,i),l=ie(r),j=le(o);return d.useEffect(()=>{const m=a.current;if(!m)return;const g=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(g,"checked").set;if(l!==r&&u){const w=new Event("click",{bubbles:n});u.call(m,r),m.dispatchEvent(w)}},[l,r,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...t,tabIndex:-1,ref:c,style:{...t.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});V.displayName=je;function W(s){return s?"checked":"unchecked"}var ge=D,we=O;function Ne({className:s,...o}){return e.jsx(ge,{"data-slot":"switch",className:M("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...o,children:e.jsx(we,{"data-slot":"switch-thumb",className:M("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const _e=Q({old_password:_().min(1,"请输入当前密码"),new_password:_().min(6,"新密码至少需要6位字符"),confirm_password:_().min(1,"请确认新密码")}).refine(s=>s.new_password===s.confirm_password,{message:"两次输入的密码不一致",path:["confirm_password"]}).refine(s=>s.old_password!==s.new_password,{message:"新密码不能与当前密码相同",path:["new_password"]});function ye(){const{send:s,loading:o}=f(({old_password:t,new_password:i})=>K({old_password:t,new_password:i}),{immediate:!1}).onSuccess(()=>{H.success("密码修改成功")}),r=re({resolver:te(_e),defaultValues:{old_password:"",new_password:"",confirm_password:""}}),n=async t=>{s({old_password:t.old_password,new_password:t.new_password}),r.reset()};return e.jsxs(A,{children:[e.jsx(E,{children:e.jsx(T,{children:"修改密码"})}),e.jsx(B,{children:e.jsx(ae,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(n),className:"space-y-4",children:[e.jsx(y,{control:r.control,name:"old_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"当前密码"}),e.jsx(k,{children:e.jsx(P,{type:"password",placeholder:"请输入当前密码",...t})}),e.jsx(C,{})]})}),e.jsx(y,{control:r.control,name:"new_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"新密码"}),e.jsx(k,{children:e.jsx(P,{type:"password",placeholder:"请输入新密码（至少6位）",...t})}),e.jsx(C,{})]})}),e.jsx(y,{control:r.control,name:"confirm_password",render:({field:t})=>e.jsxs(v,{children:[e.jsx(S,{children:"确认新密码"}),e.jsx(k,{children:e.jsx(P,{type:"password",placeholder:"请再次输入新密码",...t})}),e.jsx(C,{})]})}),e.jsx(ee,{type:"submit",className:"w-full",disabled:o,children:o?"修改中...":"修改密码"})]})})})]})}function ve(){const[s,o]=d.useState({remind_expire:!1,remind_traffic:!1});f(L).onSuccess(({data:a})=>{o({remind_expire:!!a.remind_expire,remind_traffic:!!a.remind_traffic})});const{send:r,loading:n}=f(a=>Y({remind_expire:a.remind_expire?1:0,remind_traffic:a.remind_traffic?1:0}),{immediate:!1}).onSuccess(()=>{H.success("设置已自动保存")}),t=(a,c)=>{o(l=>({...l,[a]:c})),r({...s,[a]:c})},i=[{key:"remind_expire",label:"到期提醒",description:"当您的订阅即将到期时，我们会发送提醒通知"},{key:"remind_traffic",label:"流量提醒",description:"当您的流量使用量达到一定比例时，我们会发送提醒通知"}];return e.jsxs(A,{children:[e.jsx(E,{children:e.jsx(T,{children:"通知设置"})}),e.jsx(B,{className:"space-y-4",children:i.map(a=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{children:[e.jsx(oe,{className:"text-base",children:a.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),e.jsx(Ne,{checked:s[a.key],onCheckedChange:c=>t(a.key,c),disabled:n})]},a.key))})]})}function Se(){const{setUserInfo:s}=J(),{data:o,loading:r}=f(L,{force:!0}).onSuccess(({data:n})=>{s(n)});return e.jsxs(me,{gradientPosition:"top",children:[e.jsxs(E,{className:"pb-3",children:[e.jsxs(T,{className:"flex items-center gap-2 text-lg font-bold",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-primary/10 text-primary",children:e.jsx(U,{className:"h-5 w-5"})}),"账户余额"]}),e.jsx(se,{className:"text-sm text-muted-foreground/80",children:"您的资产概览和余额详情"})]}),e.jsx(B,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(U,{className:"h-3 w-3 text-primary"})}),"账户余额"]}),r?e.jsx(I,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R(o.balance)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"可用于购买套餐"})]}),e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(pe,{className:"h-3 w-3 text-primary"})}),"佣金余额"]}),r?e.jsx(I,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R(o.commission_balance)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"邀请奖励收益"})]}),e.jsxs("div",{className:"space-y-2 p-3 rounded-xl bg-card/50 border border-border/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-muted-foreground",children:[e.jsx("div",{className:"p-1 rounded-md bg-primary/10",children:e.jsx(ue,{className:"h-3 w-3 text-primary"})}),"总资产"]}),r?e.jsx(I,{className:"h-6 w-20"}):e.jsxs("p",{className:"text-base font-semibold text-foreground",children:["¥",R((o.balance||0)+(o.commission_balance||0))]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"账户余额 + 佣金余额"})]})]})})]})}const $e=function(){return e.jsxs("div",{className:"container mx-auto space-y-6",children:[e.jsx(Se,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ye,{}),e.jsx(ve,{})]})]})};export{$e as component};
