import{b as O,r as b,K as P,j as e,L as D,M as S,t as T}from"./index-BwutXNrU-ad44d3b.js";import{B as u}from"./badge-D4AEz2mi-ad44d3b.js";import{c as M,B as o}from"./button-sGaAilqo-ad44d3b.js";import{C as N,d as f}from"./card-y9sD7IDo-ad44d3b.js";import{S as i}from"./skeleton-BwDFEDR4-ad44d3b.js";import{T as v,a as y,b as j,c as a,d as w,e as t}from"./table-gdvm4-kx-ad44d3b.js";import{A as L,a as B,b as I,c as z,d as E,e as H,f as R,g as q,h as F}from"./alert-dialog-CP51CIrv-ad44d3b.js";import{i as V,j as $,b as G}from"./formatters-DJmD54-F-ad44d3b.js";import{P as K,E as J}from"./page-header-D6sJ6hJY-ad44d3b.js";import{u as k,a as Q,b as U}from"./index.esm-h9YC-N4N-ad44d3b.js";import{C as W}from"./credit-card-Dgf7cOUJ-ad44d3b.js";import{P as X}from"./package-DoRhA6yX-ad44d3b.js";import"./utils-XCGD-6Tw-ad44d3b.js";import"./index-Ca0X4iLh-ad44d3b.js";import"./index-Cx8lFI4u-ad44d3b.js";import"./index-Dc_FVRD7-ad44d3b.js";import"./index-D68o6UF7-ad44d3b.js";import"./index-BmmjHwOG-ad44d3b.js";import"./index-BJbJFzWK-ad44d3b.js";import"./index-B6_V1-8a-ad44d3b.js";import"./index-Gah5zmSf-ad44d3b.js";import"./tslib.es6-B8VhMk5P-ad44d3b.js";import"./index-UKOundqy-ad44d3b.js";import"./circle-check-big-GDcMs1tu-ad44d3b.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],g=M("shopping-bag",Y),Z=[{key:"month_price",label:"月付"},{key:"quarter_price",label:"季付"},{key:"half_year_price",label:"半年付"},{key:"year_price",label:"年付"},{key:"two_year_price",label:"两年付"},{key:"three_year_price",label:"三年付"},{key:"onetime_price",label:"一次性"},{key:"reset_price",label:"流量重置包"}],ee=d=>{const n=Z.find(r=>r.key===d);return n?n.label:d};function se({tradeNo:d}){const{send:n,loading:r}=k(S,{immediate:!1}).onSuccess(()=>{T.success("订单已取消"),U("getOrderList",m=>{m.send()})});return e.jsxs(L,{children:[e.jsx(B,{asChild:!0,children:e.jsx(o,{variant:"outline",size:"sm",className:"text-xs px-2 py-1 text-destructive hover:text-destructive",disabled:r,children:"取消"})}),e.jsxs(I,{children:[e.jsxs(z,{children:[e.jsx(E,{children:"确认取消订单"}),e.jsx(H,{children:"确定要取消订单吗？如果您已经付款，取消订单可能会导致支付失败！"})]}),e.jsxs(R,{children:[e.jsx(q,{children:"取消"}),e.jsx(F,{onClick:async()=>{n(d)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:r,children:r?"取消中...":"确认取消"})]})]})]})}const Ce=function(){const n=O(),[r,m]=b.useState(1),x=10,{data:l,loading:_}=k(P,{middleware:Q("getOrderList")}),{paginatedOrders:C,totalPages:h}=b.useMemo(()=>{if(!l||l.length===0)return{paginatedOrders:[],totalPages:0};const s=(r-1)*x,c=s+x,p=l.slice(s,c),A=Math.ceil(l.length/x);return{paginatedOrders:p,totalPages:A}},[l,r,x]);return e.jsxs("div",{className:"container mx-auto space-y-6",children:[e.jsx(K,{title:"我的订单",description:"查看您的订单记录和支付状态",icon:g}),_?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"我的订单"}),e.jsx(i,{className:"h-6 w-20"})]})}),e.jsx(N,{className:"rounded-xl shadow-lg border border-border overflow-hidden",children:e.jsx(f,{className:"p-0",children:e.jsxs(v,{className:"table-auto",children:[e.jsx(y,{children:e.jsxs(j,{className:"bg-muted",children:[e.jsx(a,{children:"套餐名称"}),e.jsx(a,{children:"订单号"}),e.jsx(a,{children:"周期"}),e.jsx(a,{children:"下单时间"}),e.jsx(a,{children:"实付金额"}),e.jsx(a,{children:"状态"}),e.jsx(a,{className:"sticky right-0 border-l bg-muted",children:"操作"})]})}),e.jsx(w,{children:Array.from({length:5}).map((s,c)=>e.jsxs(j,{children:[e.jsx(t,{children:e.jsx(i,{className:"h-4 w-32"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-24"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-16"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-28"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-20"})}),e.jsx(t,{children:e.jsx(i,{className:"h-6 w-16"})}),e.jsx(t,{className:"sticky right-0 bg-background border-l",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[e.jsx(i,{className:"h-8 w-16"}),e.jsx(i,{className:"h-8 w-16"})]})})]},c))})]})})})]}):!l||l.length===0?e.jsx(J,{icon:X,title:"暂无订单",description:"您还没有任何订单记录，快去购买您的第一个套餐吧！",action:{text:"立即购买",icon:W,to:"/shop"}}):e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"我的订单"}),e.jsxs(u,{variant:"outline",className:"ml-2",children:["共 ",l.length," 个订单"]})]})}),e.jsx(N,{className:"rounded-xl shadow-lg border border-border overflow-hidden",children:e.jsxs(f,{className:"p-0",children:[e.jsxs(v,{className:"table-auto",children:[e.jsx(y,{children:e.jsxs(j,{className:"bg-muted",children:[e.jsx(a,{children:"套餐名称"}),e.jsx(a,{children:"订单号"}),e.jsx(a,{children:"周期"}),e.jsx(a,{children:"下单时间"}),e.jsx(a,{children:"实付金额"}),e.jsx(a,{children:"状态"}),e.jsx(a,{className:"sticky right-0 border-l bg-muted",children:"操作"})]})}),e.jsx(w,{children:C.map(s=>{const c=V(s.status),p=c.icon;return e.jsxs(j,{children:[e.jsx(t,{className:"font-medium",children:e.jsx("div",{children:e.jsx("div",{className:"font-semibold",children:s.plan?.name||"未知套餐"})})}),e.jsx(t,{className:"",children:e.jsx(o,{variant:"link",onClick:()=>{n({to:`/order/${s.trade_no}`})},children:s.trade_no})}),e.jsx(t,{className:"",children:e.jsx("div",{className:"text-sm font-medium",children:ee(s.period)})}),e.jsx(t,{className:"",children:e.jsx("div",{className:"text-sm",children:$(s.created_at)})}),e.jsx(t,{className:"",children:e.jsxs("div",{className:"font-bold text-primary",children:["¥",G(s.total_amount)]})}),e.jsx(t,{className:"",children:e.jsxs(u,{variant:c.variant,className:"flex items-center gap-1 w-fit",children:[e.jsx(p,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:c.label}),e.jsx("span",{className:"sm:hidden",children:c.label.slice(0,2)})]})}),e.jsx(t,{className:"sticky right-0 bg-background border-l",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[e.jsx(D,{to:"/order/$tradeNo",from:"/",params:{tradeNo:s.trade_no},children:e.jsx(o,{variant:"outline",size:"sm",className:"text-xs px-2 py-1",children:"详情"})}),s.status===0&&e.jsx(se,{tradeNo:s.trade_no})]})})]},s.id)})})]}),h>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["共 ",l?.length||0," 条记录，第 ",r," / ",h," 页"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.max(s-1,1)),disabled:r===1,children:"上一页"}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.min(s+1,h)),disabled:r===h,children:"下一页"})]})]})]})})]})]})};export{Ce as component};
