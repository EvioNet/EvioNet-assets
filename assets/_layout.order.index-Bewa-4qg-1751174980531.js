import{b as O,r as b,M as P,j as e,L as D,N as S,t as T}from"./index-zp2nMl9D-1751174980531.js";import{B as u}from"./badge-CwNxBKv8-1751174980531.js";import{B as o}from"./button-Cqc4v3GU-1751174980531.js";import{C as N,d as f}from"./card-Dg8wDAoB-1751174980531.js";import{S as i}from"./skeleton-BIaGqfRO-1751174980531.js";import{T as v,a as y,b as j,c as a,d as w,e as t}from"./table-ByNoSSXA-1751174980531.js";import{A as M,a as L,b as B,c as I,d as z,e as E,f as H,g as R,h as q}from"./alert-dialog-DfTWEJKU-1751174980531.js";import{i as F,j as V,b as $}from"./formatters-C5M2-kaB-1751174980531.js";import{P as G,E as J}from"./page-header-CtYKi_K4-1751174980531.js";import{u as k,b as K,c as Q}from"./index.esm-B4TPyIND-1751174980531.js";import{c as U}from"./createLucideIcon-Ru6o5lSX-1751174980531.js";import{C as W}from"./credit-card-vtF1NXY5-1751174980531.js";import{P as X}from"./package-CC7CMkB8-1751174980531.js";import"./utils-BIJI3SUY-1751174980531.js";import"./index-Decz7uho-1751174980531.js";import"./index-CYCNFEZA-1751174980531.js";import"./index-Dc_FVRD7-1751174980531.js";import"./index-BMVtMRz9-1751174980531.js";import"./index-BT14nGiI-1751174980531.js";import"./index-ZA55Yug1-1751174980531.js";import"./index-CjSUaoDh-1751174980531.js";import"./index-BZhyglrc-1751174980531.js";import"./tslib.es6-B8VhMk5P-1751174980531.js";import"./index-CgLCRNYN-1751174980531.js";import"./circle-check-big-DX17IEmj-1751174980531.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],g=U("shopping-bag",Y),Z=[{key:"month_price",label:"月付"},{key:"quarter_price",label:"季付"},{key:"half_year_price",label:"半年付"},{key:"year_price",label:"年付"},{key:"two_year_price",label:"两年付"},{key:"three_year_price",label:"三年付"},{key:"onetime_price",label:"一次性"},{key:"reset_price",label:"流量重置包"}],ee=d=>{const n=Z.find(r=>r.key===d);return n?n.label:d};function se({tradeNo:d}){const{send:n,loading:r}=k(S,{immediate:!1}).onSuccess(()=>{T.success("订单已取消"),Q("getOrderList",m=>{m.send()})});return e.jsxs(M,{children:[e.jsx(L,{asChild:!0,children:e.jsx(o,{variant:"outline",size:"sm",className:"text-xs px-2 py-1 text-destructive hover:text-destructive",disabled:r,children:"取消"})}),e.jsxs(B,{children:[e.jsxs(I,{children:[e.jsx(z,{children:"确认取消订单"}),e.jsx(E,{children:"确定要取消订单吗？如果您已经付款，取消订单可能会导致支付失败！"})]}),e.jsxs(H,{children:[e.jsx(R,{children:"取消"}),e.jsx(q,{onClick:async()=>{n(d)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:r,children:r?"取消中...":"确认取消"})]})]})]})}const Ae=function(){const n=O(),[r,m]=b.useState(1),x=10,{data:l,loading:_}=k(P,{middleware:K("getOrderList")}),{paginatedOrders:C,totalPages:h}=b.useMemo(()=>{if(!l||l.length===0)return{paginatedOrders:[],totalPages:0};const s=(r-1)*x,c=s+x,p=l.slice(s,c),A=Math.ceil(l.length/x);return{paginatedOrders:p,totalPages:A}},[l,r,x]);return e.jsxs("div",{className:"container mx-auto space-y-6",children:[e.jsx(G,{title:"我的订单",description:"查看您的订单记录和支付状态",icon:g}),_?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"我的订单"}),e.jsx(i,{className:"h-6 w-20"})]})}),e.jsx(N,{className:"rounded-xl shadow-lg border border-border overflow-hidden",children:e.jsx(f,{className:"p-0",children:e.jsxs(v,{className:"table-auto",children:[e.jsx(y,{children:e.jsxs(j,{className:"bg-muted",children:[e.jsx(a,{children:"套餐名称"}),e.jsx(a,{children:"订单号"}),e.jsx(a,{children:"周期"}),e.jsx(a,{children:"下单时间"}),e.jsx(a,{children:"实付金额"}),e.jsx(a,{children:"状态"}),e.jsx(a,{className:"sticky right-0 border-l bg-muted",children:"操作"})]})}),e.jsx(w,{children:Array.from({length:5}).map((s,c)=>e.jsxs(j,{children:[e.jsx(t,{children:e.jsx(i,{className:"h-4 w-32"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-24"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-16"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-28"})}),e.jsx(t,{children:e.jsx(i,{className:"h-4 w-20"})}),e.jsx(t,{children:e.jsx(i,{className:"h-6 w-16"})}),e.jsx(t,{className:"sticky right-0 bg-background border-l",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[e.jsx(i,{className:"h-8 w-16"}),e.jsx(i,{className:"h-8 w-16"})]})})]},c))})]})})})]}):!l||l.length===0?e.jsx(J,{icon:X,title:"暂无订单",description:"您还没有任何订单记录，快去购买您的第一个套餐吧！",action:{text:"立即购买",icon:W,to:"/shop"}}):e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"我的订单"}),e.jsxs(u,{variant:"outline",className:"ml-2",children:["共 ",l.length," 个订单"]})]})}),e.jsx(N,{className:"rounded-xl shadow-lg border border-border overflow-hidden",children:e.jsxs(f,{className:"p-0",children:[e.jsxs(v,{className:"table-auto",children:[e.jsx(y,{children:e.jsxs(j,{className:"bg-muted",children:[e.jsx(a,{children:"套餐名称"}),e.jsx(a,{children:"订单号"}),e.jsx(a,{children:"周期"}),e.jsx(a,{children:"下单时间"}),e.jsx(a,{children:"实付金额"}),e.jsx(a,{children:"状态"}),e.jsx(a,{className:"sticky right-0 border-l bg-muted",children:"操作"})]})}),e.jsx(w,{children:C.map(s=>{const c=F(s.status),p=c.icon;return e.jsxs(j,{children:[e.jsx(t,{className:"font-medium",children:e.jsx("div",{children:e.jsx("div",{className:"font-semibold",children:s.plan?.name||"未知套餐"})})}),e.jsx(t,{className:"",children:e.jsx(o,{variant:"link",onClick:()=>{n({to:`/order/${s.trade_no}`})},children:s.trade_no})}),e.jsx(t,{className:"",children:e.jsx("div",{className:"text-sm font-medium",children:ee(s.period)})}),e.jsx(t,{className:"",children:e.jsx("div",{className:"text-sm",children:V(s.created_at)})}),e.jsx(t,{className:"",children:e.jsxs("div",{className:"font-bold text-primary",children:["¥",$(s.total_amount)]})}),e.jsx(t,{className:"",children:e.jsxs(u,{variant:c.variant,className:"flex items-center gap-1 w-fit",children:[e.jsx(p,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:c.label}),e.jsx("span",{className:"sm:hidden",children:c.label.slice(0,2)})]})}),e.jsx(t,{className:"sticky right-0 bg-background border-l",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[e.jsx(D,{to:"/order/$tradeNo",params:{tradeNo:s.trade_no},children:e.jsx(o,{variant:"outline",size:"sm",className:"text-xs px-2 py-1",children:"详情"})}),s.status===0&&e.jsx(se,{tradeNo:s.trade_no})]})})]},s.id)})})]}),h>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["共 ",l?.length||0," 条记录，第 ",r," / ",h," 页"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.max(s-1,1)),disabled:r===1,children:"上一页"}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>m(s=>Math.min(s+1,h)),disabled:r===h,children:"下一页"})]})]})]})})]})]})};export{Ae as component};
